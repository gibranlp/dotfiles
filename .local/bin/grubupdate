#!/bin/bash

# Ruta al archivo colors.css generado por Pywal
CSS_FILE="$HOME/.cache/wal/colors.css"

# Archivo de configuración de colores de GRUB
GRUB_CUSTOM_CONFIG="/boot/grub/custom.cfg"

# Función para convertir colores hexadecimales a nombres de colores de GRUB
hex_to_grub_color() {
    case "$1" in
        "#000000") echo "black" ;;
        "#0000FF") echo "blue" ;;
        "#008000") echo "green" ;;
        "#00FFFF") echo "cyan" ;;
        "#FF0000") echo "red" ;;
        "#FF00FF") echo "magenta" ;;
        "#A52A2A") echo "brown" ;;
        "#D3D3D3") echo "light-gray" ;;
        "#696969") echo "dark-gray" ;;
        "#ADD8E6") echo "light-blue" ;;
        "#90EE90") echo "light-green" ;;
        "#E0FFFF") echo "light-cyan" ;;
        "#FFA07A") echo "light-red" ;;
        "#EE82EE") echo "light-magenta" ;;
        "#FFFF00") echo "yellow" ;;
        "#FFFFFF") echo "white" ;;
        *) echo "black" ;; # Valor predeterminado
    esac
}

# Extraer colores del archivo colors.css
bg_color=$(grep --color=never -m 1 'background:' $CSS_FILE | awk '{print $2}' | tr -d ';')
fg_color=$(grep --color=never -m 1 'foreground:' $CSS_FILE | awk '{print $2}' | tr -d ';')
highlight_bg=$(grep --color=never -m 1 'color8:' $CSS_FILE | awk '{print $2}' | tr -d ';')
highlight_fg=$(grep --color=never -m 1 'color7:' $CSS_FILE | awk '{print $2}' | tr -d ';')

# Convertir colores hexadecimales a nombres de colores de GRUB
bg_color_grub=$(hex_to_grub_color $bg_color)
fg_color_grub=$(hex_to_grub_color $fg_color)
highlight_bg_grub=$(hex_to_grub_color $highlight_bg)
highlight_fg_grub=$(hex_to_grub_color $highlight_fg)

# Crear el archivo de configuración de colores de GRUB
echo "set color_normal=$fg_color_grub/$bg_color_grub" | sudo tee $GRUB_CUSTOM_CONFIG
echo "set color_highlight=$highlight_fg_grub/$highlight_bg_grub" | sudo tee -a $GRUB_CUSTOM_CONFIG

echo "Colores de GRUB actualizados correctamente."
